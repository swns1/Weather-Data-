<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}WeatherScope{% endblock %}</title>

    <!-- Link CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

    {% block head %}{% endblock %}
</head>
<body>
    {% include "header.html" %}

    <main>
        {% block content %}{% endblock %}
    </main>

    {% include "footer.html" %}

   <script>
        function updateBackground() {
            const weatherCards = document.querySelectorAll('.weather-card');
            const body = document.getElementById('weather-body');
            
            if (weatherCards.length > 0) {
                // Count weather conditions across all forecast periods
                const weatherCounts = {
                    sunny: 0,
                    rainy: 0,
                    cloudy: 0,
                    stormy: 0,
                    snowy: 0,
                    clear: 0
                };
                
                // Analyze all weather cards to find dominant condition
                weatherCards.forEach(card => {
                    const description = card.querySelector('.description-text').textContent.toLowerCase();
                    
                    if (description.includes('rain') || description.includes('drizzle') || description.includes('shower')) {
                        weatherCounts.rainy++;
                    } else if (description.includes('sun') || description.includes('clear')) {
                        weatherCounts.sunny++;
                    } else if (description.includes('cloud') || description.includes('overcast') || description.includes('mist') || description.includes('fog')) {
                        weatherCounts.cloudy++;
                    } else if (description.includes('storm') || description.includes('thunder') || description.includes('lightning')) {
                        weatherCounts.stormy++;
                    } else if (description.includes('snow') || description.includes('blizzard') || description.includes('sleet')) {
                        weatherCounts.snowy++;
                    } else {
                        weatherCounts.clear++;
                    }
                });
                
                // Find the dominant weather condition
                let dominantWeather = 'clear';
                let maxCount = 0;
                
                for (const [weather, count] of Object.entries(weatherCounts)) {
                    if (count > maxCount) {
                        maxCount = count;
                        dominantWeather = weather;
                    }
                }
                
                // Remove existing weather classes
                body.className = body.className.replace(/\b(sunny|rainy|cloudy|stormy|snowy|clear)\b/g, '');
                
                // Add the dominant weather class
                body.classList.add(dominantWeather);
                
                console.log(`Weather analysis: ${JSON.stringify(weatherCounts)}, Dominant: ${dominantWeather}`);
            }
        }
        
        // Update background when page loads
        document.addEventListener('DOMContentLoaded', updateBackground);
    </script>
</body>
</html>